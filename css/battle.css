:root{ --fg:#fff; --panel:#000000c8; }
html,body{margin:0;height:100%;background:#000;color:var(--fg);font-family:"Arial","Meiryo",sans-serif;overflow:hidden;}
.hidden{display:none!important;}

/* 背景 */
#bg{position:fixed;top:0;left:0;width:100%;height:100%;object-fit:cover;z-index:0;}

/* イントロ */
#intro{position:absolute;inset:0;display:flex;flex-direction:column;align-items:center;justify-content:center;z-index:10;}
#intro img{width:240px;max-width:40vw;margin-bottom:20px;}
#intro .bubble{background:#000c;border:2px solid #fff;padding:16px 20px;border-radius:10px;font-size:20px;max-width:80vw;text-align:center;}

/* HUD */
.hud{position:absolute;left:50%;top:12px;transform:translateX(-50%);width:min(96vw,1100px);
  display:grid;grid-template-columns:1fr auto 1fr;gap:12px;align-items:end;z-index:5;}
.box{background:var(--panel);border:2px solid #fff;border-radius:10px;padding:10px 12px;}
.hpbar{height:14px;background:#333;border-radius:8px;overflow:hidden;margin-bottom:4px;}
.hpbar > div{height:100%;width:100%;background:linear-gradient(90deg,#4caf50,#8bc34a);}
.hpbar.sp{height:10px;background:#222;}
.hpbar.sp > div{background:linear-gradient(90deg,#03a9f4,#00e5ff);}
.question{font-size:clamp(22px,5.2vw,40px);}

/* フィールド */
.field{position:absolute;inset:0;display:flex;align-items:flex-end;justify-content:space-between;padding:0 4vw 10vh;z-index:5;}
.hero,.enemy{width:min(36vw,360px);max-height:60vh;object-fit:contain;transition:opacity .3s ease;}
.blink{animation:blink .15s 4;}
@keyframes blink{50%{opacity:0;}}
.jump{animation:jump .4s;}
@keyframes jump{0%{transform:translateY(0);}50%{transform:translateY(-40px);}100%{transform:translateY(0);}}

/* 入力パネル */
.panel{position:absolute;left:50%;bottom:16px;transform:translateX(-50%);width:min(96vw,740px);
  background:var(--panel);border:2px solid #fff;border-radius:12px;padding:12px;z-index:5;}
.answer{display:flex;gap:10px;align-items:center;justify-content:center;margin-bottom:10px;}
.answer input{width:180px;font-size:28px;text-align:center;padding:8px;border-radius:8px;border:2px solid #fff;background:#111;color:#fff;}
.numpad{display:grid;grid-template-columns:repeat(3,1fr);gap:8px;}
.numpad button{font-size:22px;padding:14px 0;border-radius:10px;border:none;background:#263238;color:#fff;}
.numpad button.ok{background:#1b5e20;}
#skills{display:none;margin-top:10px;grid-template-columns:repeat(3,1fr);gap:6px;}
#skills button{background:#1565c0;color:#fff;border:none;padding:8px;border-radius:6px;cursor:pointer;}
#battle-log{margin-top:10px;height:120px;overflow-y:auto;background:#0009;padding:6px;border:2px solid #fff;border-radius:8px;font-size:16px;line-height:1.5;}

/* 結果・警告・敗北ダイアログ共通 */
.result,
#warning,
#retry-dialog {
  position:absolute;inset:0;display:none;align-items:center;justify-content:center;text-align:center;background:rgba(0,0,0,.6);z-index:20;
}

.result .card,
#warning .card,
#retry-dialog .card {
  background:#000d;border:2px solid #fff;border-radius:12px;padding:20px 26px;min-width:300px;
}

.result h2,.result p,
#warning h2,#warning p,
#retry-dialog h2,#retry-dialog p {
  text-align:center;
}

/* 共通ボタンスタイル */
.result button,
#warning button,
#retry-dialog button {
  display:inline-block;
  margin-top:12px;
  margin-inline:6px;
  padding:10px 18px;
  font-size:18px;
  border:none;
  border-radius:8px;
  cursor:pointer;
  background:#1565c0;
  color:#fff;
  transition:background .2s;
}

.result button:hover,
#warning button:hover,
#retry-dialog button:hover {
  background:#0d47a1;
}

/* 敵の消滅エフェクト */
.fadeout {
  animation: fadeout 1s forwards;
}

@keyframes fadeout {
  from { opacity: 1; transform: scale(1); }
  to { opacity: 0; transform: scale(0.2); }
}
